#!/usr/bin/env python3
import sys
import os
import subprocess
import tempfile
import shutil
import argparse
import json
import shlex

# Config
DEFAULT_REPO_URL = "https://github.com/ExistingPerson08/Spacefin-cli.git"
REPO_FOLDER_NAME = "spacefin-assets"
HOME_DIR = os.path.expanduser("~")


def confirm_user_repo(repo_url):
Â  Â  """Confirm user repository."""
Â  Â  print(f"âš ï¸Â  WARNING: You are about to use a custom repository:")
Â  Â  print(f"Â  Â {repo_url}")
Â  Â  print("Â  Â This could be insecure. Only proceed if you trust the source.")
Â  Â  try:
Â  Â  Â  Â  choice = input("Â  Â Do you want to continue? [y/N]: ").strip().lower()
Â  Â  except EOFError:
Â  Â  Â  Â  choice = "n"

Â  Â  if choice != "y":
Â  Â  Â  Â  print("âŒ Aborting.")
Â  Â  Â  Â  sys.exit(0)
Â  Â  print("Proceeding with custom repository.")


def clone_repo(repo_url, temp_dir):
Â  Â  """Clone repository"""
Â  Â  clone_path = os.path.join(temp_dir, REPO_FOLDER_NAME)

Â  Â  try:
Â  Â  Â  Â  subprocess.run(
Â  Â  Â  Â  Â  Â  ["git", "clone", "--depth", "1", repo_url, clone_path],
Â  Â  Â  Â  Â  Â  check=True,
Â  Â  Â  Â  Â  Â  capture_output=True,
Â  Â  Â  Â  Â  Â  text=True,
Â  Â  Â  Â  Â  Â  encoding="utf-8",
Â  Â  Â  Â  )
Â  Â  Â  Â  return clone_path
Â  Â  except FileNotFoundError:
Â  Â  Â  Â  print(f"âŒ ERROR: 'git' command not found. Please make sure git is installed.")
Â  Â  Â  Â  sys.exit(1)
Â  Â  except subprocess.CalledProcessError as e:
Â  Â  Â  Â  print(f"âŒ ERROR: Failed to clone repository.")
Â  Â  Â  Â  if e.stderr:
Â  Â  Â  Â  Â  Â  print(f"Â  Â Details: {e.stderr.strip()}")
Â  Â  Â  Â  sys.exit(1)
Â  Â  except Exception as e:
Â  Â  Â  Â  print(f"âŒ ERROR: An unexpected error occurred during cloning: {e}")
Â  Â  Â  Â  sys.exit(1)


def run_command(command_args):
Â  Â  """Run a shell command"""
Â  Â  command_for_log = " ".join(shlex.quote(s) for s in command_args)
Â  Â  print(f"Running command: {command_for_log}")
Â  Â  try:
Â  Â  Â  Â  # Run and stream output
Â  Â  Â  Â  with subprocess.Popen(
Â  Â  Â  Â  Â  Â  command_args,
Â  Â  Â  Â  Â  Â  stdout=subprocess.PIPE,
Â  Â  Â  Â  Â  Â  stderr=subprocess.STDOUT,
Â  Â  Â  Â  Â  Â  text=True,
Â  Â  Â  Â  Â  Â  encoding="utf-8",
Â  Â  Â  Â  Â  Â  bufsize=1,
Â  Â  Â  Â  ) as proc:
Â  Â  Â  Â  Â  Â  if proc.stdout:
Â  Â  Â  Â  Â  Â  Â  Â  for line in proc.stdout:
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  print(f"Â  Â > {line.strip()}", flush=True)

Â  Â  Â  Â  Â  Â  proc.wait()Â  # Wait for the process to complete

Â  Â  Â  Â  Â  Â  if proc.returncode != 0:
Â  Â  Â  Â  Â  Â  Â  Â  print(f"âŒ ERROR: Command failed with exit code {proc.returncode}")
Â  Â  Â  Â  Â  Â  Â  Â  sys.exit(1)

Â  Â  except FileNotFoundError:
Â  Â  Â  Â  print(f"âŒ ERROR: Command not found: {command_args[0]}")
Â  Â  Â  Â  sys.exit(1)
Â  Â  except Exception as e:
Â  Â  Â  Â  print(f"âŒ ERROR: Failed to run command: {e}")
Â  Â  Â  Â  sys.exit(1)


def list_available(path, item_type):
Â  Â  """Lists available items (themes/languages)"""
Â  Â  print(f"\nAvailable {item_type}:")
Â  Â  if not os.path.isdir(path):
Â  Â  Â  Â  print(f"Â  Â (Could not find '{item_type}' directory in repository)")
Â  Â  Â  Â  return
Â  Â  try:
Â  Â  Â  Â  items = []
Â  Â  Â  Â  for item in os.listdir(path):
Â  Â  Â  Â  Â  Â  item_path = os.path.join(path, item)
Â  Â  Â  Â  Â  Â  # Check if it is a directory and not hidden
Â  Â  Â  Â  Â  Â  if os.path.isdir(item_path) and not item.startswith("."):
Â  Â  Â  Â  Â  Â  Â  Â  items.append(item)

Â  Â  Â  Â  if not items:
Â  Â  Â  Â  Â  Â  print(f"Â  Â (No {item_type} found)")
Â  Â  Â  Â  else:
Â  Â  Â  Â  Â  Â  for item in sorted(items):
Â  Â  Â  Â  Â  Â  Â  Â  print(f"Â  - {item}")
Â  Â  except OSError as e:
Â  Â  Â  Â  print(f"Â  Â (Error listing {item_type}: {e})")


def list_available_scripts(path):
Â  Â  """Lists available scripts"""
Â  Â  print(f"\nAvailable commands:")
Â  Â  if not os.path.isdir(path):
Â  Â  Â  Â  print(f"Â  Â (Could not find 'run' directory in repository)")
Â  Â  Â  Â  return
Â  Â  try:
Â  Â  Â  Â  scripts = []
Â  Â  Â  Â  for item in os.listdir(path):
Â  Â  Â  Â  Â  Â  item_path = os.path.join(path, item)
Â  Â  Â  Â  Â  Â  # Check if it is a file, ends with .sh, and not hidden
Â  Â  Â  Â  Â  Â  if (
Â  Â  Â  Â  Â  Â  Â  Â  os.path.isfile(item_path)
Â  Â  Â  Â  Â  Â  Â  Â  and item.endswith(".sh")
Â  Â  Â  Â  Â  Â  Â  Â  and not item.startswith(".")
Â  Â  Â  Â  Â  Â  ):
Â  Â  Â  Â  Â  Â  Â  Â  scripts.append(item[:-3])Â  # Remove .sh

Â  Â  Â  Â  if not scripts:
Â  Â  Â  Â  Â  Â  print(f"Â  Â (No commands found)")
Â  Â  Â  Â  else:
Â  Â  Â  Â  Â  Â  for script in sorted(scripts):
Â  Â  Â  Â  Â  Â  Â  Â  print(f"Â  - {script}")
Â  Â  except OSError as e:
Â  Â  Â  Â  print(f"Â  Â (Error listing commands: {e})")

def list_available_bundles(path):
Â  Â  """Lists available install bundles"""
Â  Â  print(f"\nAvailable bundles:")
Â  Â  if not os.path.isdir(path):
Â  Â  Â  Â  print(f"Â  Â (Could not find 'install' directory in repository)")
Â  Â  Â  Â  return
Â  Â  try:
Â  Â  Â  Â  bundles = []
Â  Â  Â  Â  for item in os.listdir(path):
Â  Â  Â  Â  Â  Â  item_path = os.path.join(path, item)
Â  Â  Â  Â  Â  Â  # Check if it is a file, ends with .json, and not hidden
Â  Â  Â  Â  Â  Â  if (
Â  Â  Â  Â  Â  Â  Â  Â  os.path.isfile(item_path)
Â  Â  Â  Â  Â  Â  Â  Â  and item.endswith(".json")
Â  Â  Â  Â  Â  Â  Â  Â  and not item.startswith(".")
Â  Â  Â  Â  Â  Â  ):
Â  Â  Â  Â  Â  Â  Â  Â  bundles.append(item[:-5])Â  # Remove .json

Â  Â  Â  Â  if not bundles:
Â  Â  Â  Â  Â  Â  print(f"Â  Â (No bundles found)")
Â  Â  Â  Â  else:
Â  Â  Â  Â  Â  Â  for bundle in sorted(bundles):
Â  Â  Â  Â  Â  Â  Â  Â  print(f"Â  - {bundle}")
Â  Â  except OSError as e:
Â  Â  Â  Â  print(f"Â  Â (Error listing bundles: {e})")

def copy(source, dest, ignore_patterns=None):
Â  Â  """Wrapper for shutil.copytree with dirs_exist_ok and error handling."""
Â  Â  print(f"ğŸ“‚ Copying files from '{os.path.basename(source)}' to '{dest}'...")
Â  Â  try:
Â  Â  Â  Â  shutil.copytree(source, dest, dirs_exist_ok=True, ignore=ignore_patterns)
Â  Â  except TypeError:
Â  Â  Â  Â  # Fallback for Python < 3.8 which lacks dirs_exist_ok
Â  Â  Â  Â  print("âš ï¸Â  WARNING: Your Python version is older (pre-3.8).")
Â  Â  Â  Â  print("Â  Â  Falling back to less robust copy method.")
Â  Â  Â  Â  try:
Â  Â  Â  Â  Â  Â  from distutils.dir_util import copy_tree

Â  Â  Â  Â  Â  Â  copy_tree(source, dest)
Â  Â  Â  Â  except ImportError:
Â  Â  Â  Â  Â  Â  print(
Â  Â  Â  Â  Â  Â  Â  Â  "âŒ ERROR: 'distutils' not found. Cannot copy files on this Python version."
Â  Â  Â  Â  Â  Â  )
Â  Â  Â  Â  Â  Â  print("Â  Â Please upgrade to Python 3.8 or newer.")
Â  Â  Â  Â  Â  Â  sys.exit(1)
Â  Â  Â  Â  except Exception as e:
Â  Â  Â  Â  Â  Â  print(f"âŒ ERROR: Failed to copy files with distutils fallback: {e}")
Â  Â  Â  Â  Â  Â  sys.exit(1)
Â  Â  except Exception as e:
Â  Â  Â  Â  print(f"âŒ ERROR: Failed to copy files.")
Â  Â  Â  Â  print(f"Â  Â Details: {e}")
Â  Â  Â  Â  sys.exit(1)


# Main functions


def handle_theme(theme_name, clone_path):
Â  Â  """Handles the installation of a theme."""
Â  Â  print(f"ğŸ”„ Installing theme: {theme_name}")
Â  Â  themes_dir = os.path.join(clone_path, "themes")
Â  Â  source_dir = os.path.join(themes_dir, theme_name)

Â  Â  if not os.path.isdir(source_dir):
Â  Â  Â  Â  print(f"âŒ ERROR: Theme '{theme_name}' not found in repository.")
Â  Â  Â  Â  list_available(themes_dir, "themes")
Â  Â  Â  Â  sys.exit(1)

Â  Â  copy(source_dir, HOME_DIR)
Â  Â  print(f"ğŸ‰ Done! Theme '{theme_name}' applied.")

Â  Â  try:
Â  Â  Â  Â  run_command(["killall", "cosmic-panel"])
Â  Â  except Exception as e:
Â  Â  Â  Â  print(f"Please, log out and log back to prevent issues.")
Â  Â  Â  Â  sys.exit(1)


def handle_language(lang_name, clone_path):
Â  Â  """Handles the installation of a language environment."""
Â  Â  print(f"ğŸ”„ Installing language environment: {lang_name}")
Â  Â  lang_dir = os.path.join(clone_path, "languages")
Â  Â  source_dir = os.path.join(lang_dir, lang_name)

Â  Â  if not os.path.isdir(source_dir):
Â  Â  Â  Â  print(f"âŒ ERROR: Language '{lang_name}' not found in repository.")
Â  Â  Â  Â  list_available(lang_dir, "languages")
Â  Â  Â  Â  sys.exit(1)

Â  Â  packages_json_path = os.path.join(source_dir, "packages.json")
Â  Â  commands_json_path = os.path.join(source_dir, "commands.json")

Â  Â  if os.path.exists(packages_json_path):
Â  Â  Â  Â  print("Found 'packages.json', processing...")
Â  Â  Â  Â  try:
Â  Â  Â  Â  Â  Â  with open(packages_json_path, "r", encoding="utf-8") as f:
Â  Â  Â  Â  Â  Â  Â  Â  packages_data = json.load(f)

Â  Â  Â  Â  Â  Â  # Example: only 'brew' is supported, based on original script
Â  Â  Â  Â  Â  Â  brew_packages = packages_data.get("brew")
Â  Â  Â  Â  Â  Â  if brew_packages and isinstance(brew_packages, list):
Â  Â  Â  Â  Â  Â  Â  Â  print("Installing Homebrew packages...")
Â  Â  Â  Â  Â  Â  Â  Â  run_command(["brew", "install"] + brew_packages)
Â  Â  Â  Â  Â  Â  # Future: add "apt", "pacman" etc. here

Â  Â  Â  Â  except json.JSONDecodeError:
Â  Â  Â  Â  Â  Â  print(f"âŒ ERROR: 'packages.json' for '{lang_name}' is corrupt.")
Â  Â  Â  Â  Â  Â  sys.exit(1)
Â  Â  Â  Â  except Exception as e:
Â  Â  Â  Â  Â  Â  print(f"âŒ ERROR: Failed processing 'packages.json': {e}")
Â  Â  Â  Â  Â  Â  sys.exit(1)
Â  Â  else:
Â  Â  Â  Â  print("No 'packages.json' found, skipping package installation.")

Â  Â  if os.path.exists(commands_json_path):
Â  Â  Â  Â  print("Found 'commands.json', processing...")
Â  Â  Â  Â  try:
Â  Â  Â  Â  Â  Â  with open(commands_json_path, "r", encoding="utf-8") as f:
Â  Â  Â  Â  Â  Â  Â  Â  commands_list = json.load(f)

Â  Â  Â  Â  Â  Â  if commands_list and isinstance(commands_list, list):
Â  Â  Â  Â  Â  Â  Â  Â  print("Running setup commands...")
Â  Â  Â  Â  Â  Â  Â  Â  for cmd_str in commands_list:
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if not isinstance(cmd_str, str):
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  print(
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  f"âš ï¸Â  WARNING: Skipping non-string command in 'commands.json': {cmd_str}"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  )
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  continue
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  try:
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  # Split command string into arguments
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  cmd_args = shlex.split(cmd_str)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if cmd_args:Â  # Ensure not an empty string
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  run_command(cmd_args)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  except ValueError as e:
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  print(
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  f"âŒ ERROR: Badly formatted command in 'commands.json': {cmd_str}"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  )
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  print(f"Â  Â Details: {e}")
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  sys.exit(1)

Â  Â  Â  Â  except json.JSONDecodeError:
Â  Â  Â  Â  Â  Â  print(f"âŒ ERROR: 'commands.json' for '{lang_name}' is corrupt.")
Â  Â  Â  Â  Â  Â  sys.exit(1)
Â  Â  Â  Â  except Exception as e:
Â  Â  Â  Â  Â  Â  print(f"âŒ ERROR: Failed processing 'commands.json': {e}")
Â  Â  Â  Â  Â  Â  sys.exit(1)
Â  Â  else:
Â  Â  Â  Â  print("No 'commands.json' found, skipping setup commands.")

Â  Â  print(f"Copying configuration files to {HOME_DIR}...")
Â  Â  ignore_files = shutil.ignore_patterns("packages.json", "commands.json")
Â  Â  copy(source_dir, HOME_DIR, ignore_patterns=ignore_files)

Â  Â  print(f"ğŸ‰ Done! Language '{lang_name}' environment setup complete.")


def handle_run(script_name, clone_path):
Â  Â  """Handles the execution of a script."""
Â  Â  print(f"ğŸ”„ Running command: {script_name}")
Â  Â  run_dir = os.path.join(clone_path, "run")
Â  Â  script_path = os.path.join(run_dir, f"{script_name}.sh")

Â  Â  if not os.path.isfile(script_path):
Â  Â  Â  Â  print(f"âŒ ERROR: Command '{script_name}' not found.")
Â  Â  Â  Â  list_available_scripts(run_dir)
Â  Â  Â  Â  sys.exit(1)

Â  Â  try:
Â  Â  Â  Â  # Make the script executable
Â  Â  Â  Â  os.chmod(script_path, 0o755)
Â  Â  except Exception as e:
Â  Â  Â  Â  print(f"âŒ ERROR: Failed to make script executable: {e}")
Â  Â  Â  Â  sys.exit(1)

Â  Â  # Run the script using bash
Â  Â  try:
Â  Â  Â  Â  subprocess.run(["bash", script_path], check=True)
Â  Â  except subprocess.SubprocessError as e:
Â  Â  Â  Â  print(f"âŒ ERROR: Failed to run command: {e}")
Â  Â  Â  Â  sys.exit(1)

def handle_install(bundle_name, clone_path):
Â  Â  """Handles the installation of a software bundle."""
Â  Â  print(f"ğŸ”„ Installing bundle: {bundle_name}")
Â  Â  install_dir = os.path.join(clone_path, "install")
Â  Â  json_path = os.path.join(install_dir, f"{bundle_name}.json")

Â  Â  if not os.path.isfile(json_path):
Â  Â  Â  Â  print(f"âŒ ERROR: Bundle '{bundle_name}.json' not found in repository.")
Â  Â  Â  Â  list_available_bundles(install_dir)
Â  Â  Â  Â  sys.exit(1)

Â  Â  print(f"Found '{bundle_name}.json', processing...")
Â  Â  try:
Â  Â  Â  Â  with open(json_path, "r", encoding="utf-8") as f:
Â  Â  Â  Â  Â  Â  bundle_data = json.load(f)

Â  Â  Â  Â  # Install Flatpak packages
Â  Â  Â  Â  flatpak_packages = bundle_data.get("flatpak")
Â  Â  Â  Â  if flatpak_packages and isinstance(flatpak_packages, list):
Â  Â  Â  Â  Â  Â  print("Installing Flatpak packages...")
Â  Â  Â  Â  Â  Â  # Add -y for non-interactive install
Â  Â  Â  Â  Â  Â  run_command(["flatpak", "install", "-y"] + flatpak_packages)
Â  Â  Â  Â  else:
Â  Â  Â  Â  Â  Â  print("No Flatpak packages to install.")

Â  Â  Â  Â  # Install Brew packages
Â  Â  Â  Â  brew_packages = bundle_data.get("brew")
Â  Â  Â  Â  if brew_packages and isinstance(brew_packages, list):
Â  Â  Â  Â  Â  Â  print("Installing Homebrew packages...")
Â  Â  Â  Â  Â  Â  run_command(["brew", "install"] + brew_packages)
Â  Â  Â  Â  else:
Â  Â  Â  Â  Â  Â  print("No Homebrew packages to install.")

Â  Â  except json.JSONDecodeError:
Â  Â  Â  Â  print(f"âŒ ERROR: '{bundle_name}.json' is corrupt.")
Â  Â  Â  Â  sys.exit(1)
Â  Â  except Exception as e:
Â  Â  Â  Â  print(f"âŒ ERROR: Failed processing '{bundle_name}.json': {e}")
Â  Â  Â  Â  sys.exit(1)

Â  Â  print(f"ğŸ‰ Done! Bundle '{bundle_name}' installation complete.")

def main():
Â  Â  parser = argparse.ArgumentParser(
Â  Â  Â  Â  description="Spacefin-cli: setup your computer",
Â  Â  Â  Â  epilog="Example: spacefin-cli theme Cosmic",
Â  Â  )
Â  Â  parser.add_argument(
Â  Â  Â  Â  "--user",
Â  Â  Â  Â  metavar="REPO_URL",
Â  Â  Â  Â  help="Use a custom repository.",
Â  Â  )

Â  Â  subparsers = parser.add_subparsers(
Â  Â  Â  Â  dest="command",
Â  Â  Â  Â  required=True,
Â  Â  Â  Â  title="Commands",
Â  Â  Â  Â  metavar="<command>",
Â  Â  Â  Â  help="The action to perform.",
Â  Â  )

Â  Â  # 'theme' subcommand
Â  Â  theme_parser = subparsers.add_parser(
Â  Â  Â  Â  "theme",
Â  Â  Â  Â  help="Install a theme.",
Â  Â  Â  Â  description="Apply a user specified theme.",
Â  Â  )
Â  Â  theme_parser.add_argument(
Â  Â  Â  Â  "name", help="Name of the theme to install (e.g., 'dracula')."
Â  Â  )

Â  Â  # 'language' subcommand
Â  Â  lang_parser = subparsers.add_parser(
Â  Â  Â  Â  "language",
Â  Â  Â  Â  help="Install a language environment.",
Â  Â  Â  Â  description="Install full preconfigured development environment for the specified language.",
Â  Â  )
Â  Â  lang_parser.add_argument(
Â  Â  Â  Â  "name", help="Name of the language to set up (e.g., 'python')."
Â  Â  )

Â  Â  # 'run' subcommand
Â  Â  run_parser = subparsers.add_parser(
Â  Â  Â  Â  "run",
Â  Â  Â  Â  help="Run a script.",
Â  Â  Â  Â  description="Run a script.",
Â  Â  )
Â  Â  run_parser.add_argument("name", help="Name of the command to run.")

Â  Â  # 'install' subcommand
Â  Â  install_parser = subparsers.add_parser(
Â  Â  Â  Â  "install",
Â  Â  Â  Â  help="Install a software bundle.",
Â  Â  Â  Â  description="Install a bundle of applications from a .json file.",
Â  Â  )
Â  Â  install_parser.add_argument(
Â  Â  Â  Â  "name", help="Name of the bundle to install."
Â  Â  )

Â  Â  # Handle case where no arguments are given
Â  Â  if len(sys.argv) == 1:
Â  Â  Â  Â  parser.print_help(sys.stderr)
Â  Â  Â  Â  sys.exit(1)

Â  Â  args = parser.parse_args()

Â  Â  # Determine repository URL
Â  Â  if args.user:
Â  Â  Â  Â  confirm_user_repo(args.user)
Â  Â  Â  Â  repo_url = args.user
Â  Â  else:
Â  Â  Â  Â  repo_url = DEFAULT_REPO_URL

Â  Â  # Use a temporary directory for cloning
Â  Â  with tempfile.TemporaryDirectory() as temp_dir:
Â  Â  Â  Â  try:
Â  Â  Â  Â  Â  Â  clone_path = clone_repo(repo_url, temp_dir)

Â  Â  Â  Â  Â  Â  # Dispatch to a handler based on the subcommand
Â  Â  Â  Â  Â  Â  if args.command == "theme":
Â  Â  Â  Â  Â  Â  Â  Â  handle_theme(args.name, clone_path)
Â  Â  Â  Â  Â  Â  elif args.command == "language":
Â  Â  Â  Â  Â  Â  Â  Â  handle_language(args.name, clone_path)
Â  Â  Â  Â  Â  Â  elif args.command == "run":
Â  Â  Â  Â  Â  Â  Â  Â  handle_run(args.name, clone_path)
Â  V Â  Â  Â  Â  elif args.command == "install":
Â  Â  Â  Â  Â  Â  Â  Â  handle_install(args.name, clone_path)

Â  Â  Â  Â  except Exception as e:
Â  Â  Â  Â  Â  Â  print(f"âŒ An unexpected critical error occurred: {e}")
Â  Â  Â  Â  Â  Â  import traceback

Â  Â  Â  Â  Â  Â  traceback.print_exc()
Â  Â  Â  Â  Â  Â  sys.exit(1)


if __name__ == "__main__":
Â  Â  main()
